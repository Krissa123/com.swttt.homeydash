<!doctype html>
<html>

<head>
    <script type="text/javascript" src="/manager/webserver/assets/js/jquery.js"></script>
    <script type="text/javascript" src="/manager/webserver/assets/js/angular.js"></script>
    <script>
        angular.module('homeydashSettings', [])
            .controller('settingsCtrl', ['$scope', function($scope) {

                $scope.config = {};
                $scope.serverStatus = null;


                Homey.get('config', function(err, state) {
                    if (state) {
                        $scope.config = state;
                        console.log(state);
                        $scope.$apply();
                    };
                });


                $scope.saveConfig = function() {
                    Homey.set('config', $scope.config);




                };



            }]);

        function onHomeyReady() {
            Homey.ready();
            angular.bootstrap(document, ['homeydashSettings']);
        }
    </script>
</head>

<body ng-controller="settingsCtrl" ng-cloak>

    <h1>HomeyDash Settings</h1>
    <p>To function properly HomeyDash needs a bearer token to get devices states and give the dashboard the ability to switch devices.<br/>
        <br/>

        <b>How to find your bearer token</b><br/>
        <i>You can find your bearer token by going to http://my.athom.com and login.
      When you see the big homey, right click on it an chose to save the link. Copy the link somewhere read-able (notepad for example), and you will see bearer_token=YOURTOKENHERE.
      Copy that part in the field below here.</i>
        <p>

            <fieldset>
                <legend>Add your bearer token</legend>
                <label for="bearertoken">Bearer token</label>
                <input id="bearertoken" ng-model="config.bearertoken" type="text" value="">
                <button ng-click="saveConfig()">Save</button>

            </fieldset>

            <fieldset>
                <legend>HomeyDash</legend>

                <button ng-disabled="!config.bearertoken" onclick="window.open('/app/com.swttt.homeydash/','_blank');">Go to HomeyDash</button>
                <button ng-disabled="!config.bearertoken" onclick="window.open('/app/com.swttt.homeydash/#!/setup','_blank');">Go to settings</button>
            </fieldset>









</body>

</html>
